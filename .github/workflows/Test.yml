name: Filmyzilla Connection Test ğŸ“³

on:
  workflow_dispatch: # ğŸ”˜ à¤¬à¤Ÿà¤¨ à¤¦à¤¬à¤¾à¤“ à¤”à¤° à¤¸à¤š à¤œà¤¾à¤¨à¥‹

jobs:
  debug-connection:
    runs-on: ubuntu-latest
    steps:
    - name: ğŸ“‚ Checkout
      uses: actions/checkout@v4

    - name: ğŸ Set up Python
      uses: actions/setup-python@v5
      with:
        python-version: '3.10'

    - name: ğŸ“¦ Install Dependencies
      run: pip install requests beautifulsoup4

    - name: ğŸŒ Deep Scan Connection
      run: |
        python3 -c "
        import requests
        from bs4 import BeautifulSoup

        headers = {
            'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36',
            'Accept-Language': 'en-US,en;q=0.9',
            'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8'
        }
        
        # Test URLs (Main and Category)
        urls = [
            'https://www.filmyzilla32.com/',
            'https://www.filmyzilla32.com/category/hollywood-movies-in-hindi-dubbed.html'
        ]

        for url in urls:
            print(f'\nğŸš€ TESTING URL: {url}')
            try:
                resp = requests.get(url, headers=headers, timeout=20)
                print(f'ğŸ“¡ STATUS CODE: {resp.status_code}')
                print(f'ğŸ“Š PAGE SIZE: {len(resp.text)} bytes')

                if resp.status_code == 200:
                    soup = BeautifulSoup(resp.text, 'html.parser')
                    
                    # 1. Check for Movies/Categories
                    links = soup.select('div.touch a')
                    print(f'ğŸ”— LINKS FOUND (div.touch a): {len(links)}')
                    
                    # 2. Check for Cloudflare / Protection
                    if 'Cloudflare' in resp.text or 'Checking your browser' in resp.text:
                        print('ğŸ›‘ ALERT: Cloudflare Protection is blocking the bot!')
                    elif len(links) == 0:
                        print('âš ï¸ WARNING: Page loaded but NO LINKS found. Selector might be wrong or site layout changed.')
                        print('--- PAGE PREVIEW (First 500 chars) ---')
                        print(resp.text[:500])
                    else:
                        print(f'âœ… SUCCESS: Found {len(links)} links. Sample: {links[0].get(\"href\")}')

                elif resp.status_code == 403:
                    print('ğŸš« FORBIDDEN: GitHub IP is explicitly blocked!')
                else:
                    print(f'âŒ FAILED: Received code {resp.status_code}')

            except Exception as e:
                print(f'ğŸš¨ CRASHED: {e}')
        "
